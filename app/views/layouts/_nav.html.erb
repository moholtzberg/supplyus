<% a = current_user.roles.map {|r| r.permissions.map(&:mdl_name)}.flatten %>
<% if current_user.roles.map(&:name).include?("super_admin") %>
	<% a = Role::MODELS_LIST.map(&:to_s) %>
<% end %>
<ul class="nav nav-pills nav-stacked">
	<% if a.include?("static_page") %>
	<li>
		<a href="#static_pages_menu" data-toggle="collapse">Static Pages <i class="fa fa-caret-down pull-right"></i></a>
		<ul id="static_pages_menu" class="sub-menu list-group collapse">
			<% if a.include?("static_page") %>
			<li class="<% if current_page?(:static_pages) %>active<% end %>"><%= link_to "Static Pages", static_pages_path %></li>
			<% end %>
		</ul>
	</li>
	<% end %>
	
	<% if a.include?("customer") %>
	<li>
		<a href="#customers_menu" data-toggle="collapse">Customers <i class="fa fa-caret-down pull-right"></i></a>
		<ul id="customers_menu" class="sub-menu list-group collapse">
			<% if a.include?("account") %>
			<li class="<% if current_page?(:accounts) %>active<% end %>"><%= link_to "Accounts", accounts_path %></li>
			<% end %>
			
			<% if a.include?("account_payment_service") %>
			<li class="<% if current_page?(:account_payment_services) %>active<% end %>"><%= link_to "Account Payment Services", account_payment_services_path %></li>
			<% end %>

			<% if a.include?("address") %>
			<li class="<% if current_page?(:addresses) %>active<% end %>"><%= link_to "Addresses", addresses_path %></li>
			<% end %>
			
			<% if a.include?("credit_card") %>
			<li class="<% if current_page?(:credit_cards) %>active<% end %>"><%= link_to "Credit Cards", credit_cards_path %></li>
			<% end %>

			<% if a.include?("customer") %>
			<li class="<% if current_page?(:customers) %>active<% end %>"><%= link_to "Customers", customers_path %></li>
			<% end %>
			
			<% if a.include?("user") %>
			<li class="<% if current_page?(:users) %>active<% end %>"><%= link_to "Users", users_path %></li>
			<% end %>
			
			<% if a.include?("group") %>
			<li class="<% if current_page?(:groups) %>active<% end %>"><%= link_to "Groups", groups_path %></li>
			<% end %>

			<% if a.include?("item_list") %>
			<li class="<% if current_page?(:item_lists) %>active<% end %>"><%= link_to "Item Lists", item_lists_path %></li>
			<% end %>

			<% if a.include?("email_delivery") %>
			<li class="<% if current_page?(:email_deliveries) %>active<% end %>"><%= link_to "Email Deliveries", email_deliveries_path %></li>
			<% end %>
		</ul>
	</li>
	<% end %>
	
	<% if a.include?("order") %>
	<li>
		<a href="#orders_menu" data-toggle="collapse">Orders <i class="fa fa-caret-down pull-right"></i></a>
		<ul id="orders_menu" class="sub-menu list-group collapse">
			<% if a.include?("order") %>
			<li class="<% if current_page?(:orders) %>active<% end %>"><%= link_to "Orders", orders_path %></li>
			<% end %>
			
			<% if a.include?("payment") %>
			<li class="<% if current_page?(:payments) %>active<% end %>"><%= link_to "Payments", payments_path %></li>
			<% end %>

			<% if a.include?("subscription") %>
			<li class="<% if current_page?(:subscriptions) %>active<% end %>"><%= link_to "Subscriptions", subscriptions_path %></li>
			<% end %>

			<% if a.include?("return_authorization") %>
			<li class="<% if current_page?(:return_authorizations) %>active<% end %>"><%= link_to "Return Authorizations", return_authorizations_path %></li>
			<% end %>

			<% if a.include?("discount_code") %>
			<li class="<% if current_page?(:discount_codes) %>active<% end %>"><%= link_to "Discount Codes", discount_codes_path %></li>
			<% end %>
		</ul>
	</li>
	<% end %>
	
	<% if a.include?("purchase_order") %>
	<li>
		<a href="#purchase_orders_menu" data-toggle="collapse">Purchasing <i class="fa fa-caret-down pull-right"></i></a>
		<ul id="purchase_orders_menu" class="sub-menu list-group collapse">
			<% if a.include?("purchase_order") %>
			<li class="<% if current_page?(:purchase_orders) %>active<% end %>"><%= link_to "Purchase Orders", purchase_orders_path %></li>
			<% end %>
			
			<% if a.include?("vendor") %>
			<li class="<% if current_page?(:vendors) %>active<% end %>"><%= link_to "Vendors", vendors_path %></li>
			<% end %>
		</ul>
	</li>
	<% end %>
	
	<% if a.include?("item") %>
	<li>
		<a href="#items_menu" data-toggle="collapse">Items <i class="fa fa-caret-down pull-right"></i></a>
		<ul id="items_menu" class="sub-menu list-group collapse">
			<% if a.include?("item") %>
			<li class="<% if current_page?(:items) %>active<% end %>"><%= link_to "Items", items_path %></li>
			<% end %>
			
			<% if a.include?("brand") %>
			<li class="<% if current_page?(:brands) %>active<% end %>"><%= link_to "Brands", brands_path %></li>
			<% end %>
			
			<% if a.include?("category") %>
			<li class="<% if current_page?(:categories) %>active<% end %>"><%= link_to "Categories", categories_path %></li>
			<% end %>
			
			<% if a.include?("inventory") %>
			<li class="<% if current_page?(:inventories) %>active<% end %>"><%= link_to "Inventory", inventories_path %></li>
			<% end %>

			<% if a.include?("bin") %>
			<li class="<% if current_page?(:bins) %>active<% end %>"><%= link_to "Bins", bins_path %></li>
			<% end %>

			<% if a.include?("warehouse") %>
			<li class="<% if current_page?(:warehouses) %>active<% end %>"><%= link_to "Warehouses", warehouses_path %></li>
			<% end %>

		</ul>
	</li>
	<% end %>
	
	<% if a.include?("equipment") %>
	<li>
		<a href="#equipment_menu" data-toggle="collapse">Equipment <i class="fa fa-caret-down pull-right"></i></a>
		<ul id="equipment_menu" class="sub-menu list-group collapse">
			<% if a.include?("equipment") %>
			<li class="<% if current_page?(:equipment_index) %>active<% end %>"><%= link_to "Equipment", equipment_index_path %></li>
			<% end %>
			
			<% if a.include?("make") %>
			<li class="<% if current_page?(:makes) %>active<% end %>"><%= link_to "Makes", makes_path %></li>
			<% end %>
			
			<% if a.include?("machine_model") %>
			<li class="<% if current_page?(:machine_models) %>active<% end %>"><%= link_to "Machine Models", machine_models_path %></li>
			<% end %>
			
			<% if a.include?("equipment_alert") %>
			<li class="<% if current_page?(:equipment_alerts) %>active<% end %>"><%= link_to "Equipment Alerts", equipment_alerts_path %></li>
			<% end %>
		</ul>
	</li>
	<% end %>
	
	
	<% if a.include?("SKIP") %><li class="<% if current_page?(:invoices) %>active<% end %>"><%= link_to "Invoices", invoices_path %></li><% end %>
	
	<% if a.include?("report") %>
		<li>
			<a href="#reports_menu" data-toggle="collapse">Reports <i class="fa fa-caret-down pull-right"></i></a>
			<ul id="reports_menu" class="sub-menu list-group collapse">
				<li class="<% if current_page?(:sales_tax_reports) %>active<% end %>"><%= link_to "Sales Tax Report", sales_tax_reports_path %></li>
				<li class="<% if current_page?(:item_usage_reports) %>active<% end %>"><%= link_to "Item Usage Report", item_usage_reports_path %></li>
				<li class="<% if current_page?(:ar_aging_reports) %>active<% end %>"><%= link_to "AR Aging Report", ar_aging_reports_path %></li>
			</ul>
		</li>
	<% end %>
	
	<% if a.include?("setting") %>
		<li>
			<a href="#settings_menu" data-toggle="collapse">Settings <i class="fa fa-caret-down pull-right"></i></a>
			<ul id="settings_menu" class="sub-menu list-group collapse">
				<li class="<% if current_page?(:schedules) %>active<% end %>"><%= link_to "Schedules", schedules_path %></li>
				<li class="<% if current_page?(:settings) %>active<% end %>"><%= link_to "General Settings", settings_path %></li>
				<li class="<% if current_page?(:tax_rates) %>active<% end %>"><%= link_to "Tax Rates", tax_rates_path %></li>
				<% if a.include?("role") %>
				<li class="<% if current_page?(:roles) %>active<% end %>"><%= link_to "Roles", roles_path %></li>
				<% end %>
			</ul>
		</li>
	<% end %>
	
	
	<!-- <li class="<%# if current_page?(:path => :charges) %>active<%# end %>"><%= link_to "Charges", charges_path %></li> -->
	<% if a.include?("quickbooks") %>
	<li>
		<%# session[:token] = nil %>
		<% unless session[:token] %>
		    <ipp:connectToIntuit></ipp:connectToIntuit>
		<% else %>
			<% if Setting.find_by(:key => "qb_token").nil? %>
				<%# Setting.create(:key => "qb_token", :value => session[:token]) %>
			<% end %>
			<div class="alert alert-info alert-sm">
				Your QucikBooks account is connnected!
			</div>
		<% end %>
	</i>
	<% end %>
</ul>